\documentclass{article}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{ctex}
\usepackage{graphicx}
\usepackage{float}
\usepackage{geometry}
\geometry{a4paper,scale=0.8}
\usepackage{caption}
\usepackage{subcaption}
\newcommand{\oiint}{\mathop{{\int\!\!\!\!\!\int}\mkern-21mu \bigcirc} {}}
\newcommand*{\dif}{\mathop{}\!\mathrm{d}}

\usepackage{parskip}
\setlength{\parindent}{0cm}


\author{胡喜平}
\title{理论力学公式推导}

\begin{document}
\maketitle

\section{达朗贝尔原理}

对于稳定的系统，有
\begin{equation}
  \sum\limits_{\alpha} \mathbf{F}_{\alpha} \cdot \delta \mathbf{r}_{\alpha} = 0
\end{equation}
将$\mathbf{F}_{\alpha}$分解为外力$\mathbf{F}_{\alpha}^{e}$和内力（约束力）$\mathbf{f}_{\alpha}$，其中
\begin{equation}
  \sum\limits_{\alpha} \mathbf{f}_{\alpha} \cdot \delta \mathbf{r}_{\alpha} = 0
\end{equation}
因此有
\begin{equation}
  \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot \delta \mathbf{r}_{\alpha} = 0
\end{equation}
当问题不是静力学问题的时候，我们添加一个惯性力使之化为静力学问题，由于$\mathbf{F}_{\alpha} - \dot{\mathbf{p}}_{\alpha} = 0$
\begin{equation}
  \label{eq:0}
  \sum\limits_{\alpha}\left(\mathbf{F}_{\alpha}^{e} - \dot{\mathbf{p}}_{\alpha} \right) \cdot \delta \mathbf{r}_{\alpha} = 0
\end{equation}
这就是达朗贝尔准则

\section{拉格朗日方程}

\subsection{广义坐标}
位置$\mathbf{r}_{\alpha}$可以由坐标$q_{j}$表示
\begin{equation}
  \label{eq:5}
  \mathbf{r}_{\alpha} = \mathbf{r}_{\alpha} \left( q_{j},t \right)
\end{equation}
对它求导
\begin{equation}
  \label{eq:6}
  \dot{\mathbf{r}}_{\alpha} = \frac{\dif \mathbf{r}_{\alpha}}{\dif t} = \sum\limits_{j} \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \dot{q_{j}} + \frac{\partial \mathbf{r}_{\alpha}}{\partial t}
\end{equation}
进而得到
\begin{equation}
  \label{eq:1}
  \delta \mathbf{r}_{\alpha}= \sum\limits_{j} \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \delta q_{j}
\end{equation}

\subsection{拉格朗日方程的推导}
又方程\ref{eq:0}可以得到
\begin{equation}
  \label{eq:8}
  \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot \delta \mathbf{r}_{\alpha} =  \sum\limits_{\alpha} \dot{\mathbf{p}}_{\alpha} \cdot \delta \mathbf{r}_{\alpha}
\end{equation}
对左边进行展开，代入\ref{eq:1}
\begin{equation}
  \label{eq:2}
  \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot \delta \mathbf{r}_{\alpha} = \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot  \sum\limits_{j} \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \delta q_{j} = \sum\limits_{j} \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \delta q_{j}
\end{equation}
定义广义力$Q_{j}$
\begin{equation}
  \label{eq:3}
  \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} = Q_{j}
\end{equation}
则式\ref{eq:8}左边可以化为
\begin{equation}
  \label{eq:11}
  \sum\limits_{\alpha} \mathbf{F}_{\alpha}^{e} \cdot \delta \mathbf{r}_{\alpha} = \sum\limits_{j} Q_{j} \delta q_{j}
\end{equation}
下面我们对右边进行展开，同样，代入\ref{eq:1}
\begin{equation}
  \label{eq:12}
  \sum\limits_{\alpha} \dot{\mathbf{p}}_{\alpha} \cdot \delta \mathbf{r}_{\alpha} = \sum\limits_{\alpha} \dot{\mathbf{p}}_{\alpha} \cdot \sum\limits_{j} \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \delta q_{j} = \sum\limits_{\alpha}m_{\alpha} \ddot{\mathbf{r}}_{\alpha}  \cdot \sum\limits_{j} \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \delta q_{j} =  \sum\limits_{\alpha} \sum\limits_{j} m_{\alpha} \ddot{\mathbf{r}}_{\alpha}  \cdot  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \delta q_{j}
\end{equation}
运用复合函数求导法则
\begin{equation}
  \label{eq:13}
  \frac{\dif}{\dif t} \left( m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \right) = m_{\alpha} \ddot{\mathbf{r}}_{\alpha}  \cdot  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} + m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\dif}{\dif t} \left(  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}}  \right)
\end{equation}
即
\begin{equation}
  \label{eq:14}
  m_{\alpha} \ddot{\mathbf{r}}_{\alpha}  \cdot  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} = \frac{\dif}{\dif t} \left( m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \right) -  m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\dif}{\dif t} \left(  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}}  \right)
\end{equation}
把\ref{eq:14}代入\ref{eq:12}，得到
\begin{equation}
  \label{eq:15}
  \sum\limits_{\alpha} \dot{\mathbf{p}}_{\alpha} \cdot \delta \mathbf{r}_{\alpha} = \sum\limits_{\alpha} \sum\limits_{j} \left[ \frac{\dif}{\dif t} \left( m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \right) -  m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\dif}{\dif t} \left(  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}}  \right) \right]\delta q_{j}
\end{equation}
因为
\begin{equation}
  \frac{\dif}{\dif t} \left(  \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \right) = \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial q_{j}}
\end{equation}
我们得到
\begin{equation}
  \label{eq:17}
  \sum\limits_{\alpha} \dot{\mathbf{p}}_{\alpha} \cdot \delta \mathbf{r}_{\alpha} = \sum\limits_{\alpha} \sum\limits_{j} \left[ \frac{\dif}{\dif t} \left( m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}} \right) -  m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot  \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial q_{j}} \right]\delta q_{j}
\end{equation}
对\ref{eq:6}求偏导
\begin{equation}
  \label{eq:18}
  \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial \dot{q_{j}}} = \frac{\partial \mathbf{r}_{\alpha}}{\partial q_{j}}
\end{equation}
带入\ref{eq:17}
\begin{equation}
  \label{eq:19}
  \sum\limits_{\alpha} \dot{\mathbf{p}}_{\alpha} \cdot \delta \mathbf{r}_{\alpha} = \sum\limits_{\alpha} \sum\limits_{j} \left[ \frac{\dif}{\dif t} \left( m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial \dot{q_{j}}} \right) -  m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot  \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial q_{j}} \right]\delta q_{j}
\end{equation}
将\ref{eq:11}和\ref{eq:19}代入\ref{eq:8}
\begin{equation}
  \label{eq:20}
  \sum\limits_{\alpha} \sum\limits_{j} \left[ \frac{\dif}{\dif t} \left( m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial \dot{q_{j}}} \right) -  m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot  \frac{\partial \dot{\mathbf{r}}_{\alpha}}{\partial q_{j}} \right]\delta q_{j} = \sum\limits_{j} Q_{j} \delta q_{j}
\end{equation}
定义动能$T = \sum\limits_{\alpha} \frac{1}{2} m_{\alpha} \dot{\mathbf{r}}_{\alpha}^{2}$
\begin{equation}
  \label{eq:21}
  \partial T = \partial \left( \sum\limits_{\alpha} \frac{1}{2} m_{\alpha} \dot{\mathbf{r}}_{\alpha}^{2} \right) = \sum\limits_{\alpha} m_{\alpha} \dot{\mathbf{r}}_{\alpha} \cdot \partial \dot{\mathbf{r}}_{\alpha}
\end{equation}
将\ref{eq:21}代入\ref{eq:20}
\begin{equation}
  \label{eq:22}
  \sum\limits_{j} \left[ \frac{\dif}{\dif t} \left( \frac{\partial T}{\partial \dot{q_{j}}} \right) - \frac{\partial T}{\partial q_{j}} \right]\delta q_{j} = \sum\limits_{j} Q_{j} \delta q_{j}
\end{equation}
因此
\begin{equation}
  \label{eq:23}
  \frac{\dif}{\dif t} \left( \frac{\partial T}{\partial \dot{q_{j}}} \right) - \frac{\partial T}{\partial q_{j}} = Q_{j}
\end{equation}
即
\begin{equation}
  \label{eq:24}
  \frac{\dif}{\dif t} \left( \frac{\partial T}{\partial \dot{q_{j}}} \right) - \left( \frac{\partial T}{\partial q_{j}} + Q_{j} \right) = 0
\end{equation}
当$Q_{j}$是保守力，势能为$U$时
\begin{equation}
  \label{eq:25}
  -\frac{\partial U}{\partial q_{j}} = Q_{j}
\end{equation}
\begin{equation}
  \label{eq:26}
  \frac{\partial U}{\partial \dot{q_{j}}} = 0
\end{equation}
方程\ref{eq:24}可以化为
\begin{equation}
  \label{eq:27}
  \frac{\dif}{\dif t} \left( \frac{\partial (T-U)}{\partial \dot{q_{j}}} \right) - \frac{\partial (T-U)}{\partial q_{j}} = 0
\end{equation}
定义$L = T - U$，则
\begin{equation}
  \label{eq:28}
  \frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q_{j}}} \right) - \frac{\partial L}{\partial q_{j}} = 0
\end{equation}

\section{哈密顿量的守恒}

对$L \left( q, \dot{q} ,t \right)$求导
\begin{equation}
  \label{eq:29}
  \frac{\dif L}{\dif t} = \sum\limits_{j} \frac{\partial L}{\partial q_{j}} \dot{q_{j}} + \sum\limits_{j} \frac{\partial L}{\partial \dot{q}_{j}} \ddot{q_{j}} + \frac{\partial L}{\partial t}
\end{equation}
式\ref{eq:28}告诉我们
\begin{equation}
  \label{eq:30}
  \frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q_{j}}} \right) = \frac{\partial L}{\partial q_{j}}
\end{equation}
将\ref{eq:30}代入\ref{eq:29}
\begin{equation}
  \label{eq:31}
  \frac{\dif L}{\dif t} = \sum\limits_{j}\frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q_{j}}} \right)  \dot{q_{j}} + \sum\limits_{j} \frac{\partial L}{\partial \dot{q}_{j}} \ddot{q_{j}} + \frac{\partial L}{\partial t}
\end{equation}
即
\begin{equation}
  \label{eq:32}
  \frac{\dif L}{\dif t} = \sum\limits_{j}\frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q_{j}}} \dot{q_{j}} \right) + \frac{\partial L}{\partial t}
\end{equation}
交换求和与微分顺序
\begin{equation}
  \label{eq:33}
  \frac{\dif L}{\dif t} = \frac{\dif}{\dif t} \left( \sum\limits_{j}  \frac{\partial L}{\partial \dot{q_{j}}} \dot{q_{j}} \right) + \frac{\partial L}{\partial t}
\end{equation}
移项
\begin{equation}
  \label{eq:34}
  \frac{\dif}{\dif t} \left( \sum\limits_{j} \frac{\partial L}{\partial \dot{q_{j}}} \dot{q_{j}} -L \right) + \frac{\partial L}{\partial t} = 0
\end{equation}
定义系统的哈密顿量
\begin{equation}
  \label{eq:35}
  H = \sum\limits_{j} \frac{\partial L}{\partial \dot{q_{j}}} \dot{q_{j}} -L 
\end{equation}
当$\frac{\partial L}{\partial t}=0$时
\begin{equation}
  \label{eq:36}
  \frac{\dif H}{\dif t} = 0
\end{equation}
哈密顿量守恒

\section{Noether定理与广义动量}

由\ref{eq:33}
\begin{equation}
  \label{eq:37}
  \frac{\dif L}{\dif t} = \frac{\dif}{\dif t} \left( \sum\limits_{j}  \frac{\partial L}{\partial \dot{q_{j}}} \dot{q_{j}} \right) + \frac{\partial L}{\partial t}
\end{equation}
可以得到
\begin{equation}
  \label{eq:38}
  \delta L= \frac{\dif}{\dif t} \left( \sum\limits_{j}  \frac{\partial L}{\partial \dot{q_{j}}} \delta q_{j} \right)
\end{equation}
当空间具有平移不变性时，即虚位移的产生对于拉格朗日量没有影响时
\begin{equation}
  \label{eq:39}
  \delta L =0
\end{equation}
因此
\begin{equation}
  \label{eq:40}
  \frac{\dif}{\dif t} \left( \sum\limits_{j}  \frac{\partial L}{\partial \dot{q_{j}}} \delta q_{j} \right) = 0
\end{equation}
即
\begin{equation}
  \label{eq:41}
  \sum\limits_{j}  \frac{\partial L}{\partial \dot{q_{j}}} \delta q_{j} = \mathrm{const}
\end{equation}
因此定义广义动量
\begin{equation}
  \label{eq:42}
  p_{j} = \frac{\partial L}{\partial \dot{q_{j}}}
\end{equation}
则$p_{j} = \mathrm{const}$，广义动量守恒

\section{欧拉变分原理}

设
\begin{equation}
  \label{eq:43}
  J = \int_{x_{1}}^{x_{2}} f \left\{ y(x),y'(x);x  \right\} \dif x
\end{equation}
$J$是函数$y(x)$的函数，求$J$的极值函数，方法是另
\begin{equation}
  \label{eq:44}
  y \left( \alpha ,x \right) = y(x) + \alpha \eta (x)
\end{equation}
则
\begin{equation}
  \label{eq:45}
  y' \left( \alpha ,x \right) = y'(x) + \alpha \eta' (x)
\end{equation}
\begin{equation}
  \label{eq:46}
  \frac{\partial y}{\partial \alpha} = \eta (x)
\end{equation}
\begin{equation}
  \label{eq:47}
  \frac{\partial y'}{\partial \alpha} = \eta' (x)
\end{equation}
求解
\begin{equation}
  \label{eq:48}
  \frac{\partial J}{\partial \alpha} = 0
\end{equation}
解法为
\begin{equation}
  \label{eq:49}
  \frac{\partial J}{\partial \alpha} = \frac{\partial}{\partial \alpha} \int_{x_{1}}^{x_{2}} f \left\{ y(x),y'(x);x  \right\} \dif x =  \int_{x_{1}}^{x_{2}} \left( \frac{\partial f}{\partial y} \frac{\partial y}{\partial \alpha} + \frac{\partial f}{\partial y'} \frac{\partial y'}{\partial \alpha} \right) \dif x
\end{equation}
将\ref{eq:45}和\ref{eq:46}代入
\begin{equation}
  \label{eq:50}
  \frac{\partial J}{\partial \alpha} = \int_{x_{1}}^{x_{2}} \left( \frac{\partial f}{\partial y} \eta (x) + \frac{\partial f}{\partial y'} \eta' (x) \right) \dif x = \int_{x_{1}}^{x_{2}} \frac{\partial f}{\partial y} \eta (x) \dif x + \int_{x_{1}}^{x_{2}} \frac{\partial f}{\partial y'} \eta' (x) \dif x
\end{equation}
利用分步积分法算式\ref{eq:50}的最后一项
\begin{equation}
  \label{eq:51}
   \int_{x_{1}}^{x_{2}} \frac{\partial f}{\partial y'} \eta'(x) \dif x =  \int_{x_{1}}^{x_{2}} \frac{\partial f}{\partial y'} \dif \eta (x) = \frac{\partial f}{\partial y'} \left[ \eta (x_{1}) - \eta (x_{2}) \right] - \int_{x_{1}}^{x_{2}} \eta (x) \dif \left( \frac{\partial f}{\partial y'} \right)
 \end{equation}
 由于式\ref{eq:44}中$y(\alpha,x_{1}) = y(x_{1})$且$y(\alpha,x_{2}) = y(x_{2})$
 \begin{equation}
   \label{eq:52}
    \eta (x_{1}) = \eta (x_{2}) = 0
  \end{equation}
代入\ref{eq:51}
 \begin{equation}
   \label{eq:53}
   \int_{x_{1}}^{x_{2}} \frac{\partial f}{\partial y'} \eta'(x) \dif x = - \int_{x_{1}}^{x_{2}} \eta (x) \dif \left( \frac{\partial f}{\partial y'} \right) = - \int_{x_{1}}^{x_{2}} \eta (x) \frac{\dif}{\dif x} \left( \frac{\partial f}{\partial y'} \right) \dif x
 \end{equation}
 代入\ref{eq:50}
 \begin{equation}
   \label{eq:54}
   \frac{\partial J}{\partial \alpha} = \int_{x_{1}}^{x_{2}} \frac{\partial f}{\partial y} \eta (x) \dif x - \int_{x_{1}}^{x_{2}} \eta (x) \frac{\dif}{\dif x} \left( \frac{\partial f}{\partial y'} \right) \dif x = \int_{x_{1}}^{x_{2}} \left[ \frac{\partial f}{\partial y} -  \frac{\dif}{\dif x} \left( \frac{\partial f}{\partial y'} \right) \right]\eta (x) \dif x = 0
\end{equation}
 因此
\begin{equation}
   \label{eq:55}
   \frac{\partial f}{\partial y} -  \frac{\dif}{\dif x} \left( \frac{\partial f}{\partial y'} \right) = 0
 \end{equation}
 我们也可以用$\delta$记号表示，由式\ref{eq:54}和\ref{eq:46}
 \begin{equation}
   \label{eq:56}
    \frac{\partial J}{\partial \alpha} \dif \alpha = \int_{x_{1}}^{x_{2}} \left[ \frac{\partial f}{\partial y} -  \frac{\dif}{\dif x} \left( \frac{\partial f}{\partial y'} \right) \right] \frac{\partial y}{\partial \alpha} \dif \alpha \dif x = 0
  \end{equation}
  即
  \begin{equation}
    \label{eq:57}
    \delta J = \int_{x_{1}}^{x_{2}} \left[ \frac{\partial f}{\partial y} -  \frac{\dif}{\dif x} \left( \frac{\partial f}{\partial y'} \right) \right] \delta  y \dif x = 0
  \end{equation}

  \section{哈密顿原理}

  哈密顿原理的表示形式为
  \begin{equation}
    \label{eq:58}
    I = \int_{t_{1}}^{t_{2}} L \left( q_{j},\dot{q}_{j},t \right) \dif t= 0
  \end{equation}
  或
  \begin{equation}
    \label{eq:59}
    \delta I = \delta \int_{t_{1}}^{t_{2}} L \left( q_{j},\dot{q}_{j},t \right) \dif t= 0
  \end{equation}
  由式\ref{eq:55}我们已经知道，式\ref{eq:59}的解是
  \begin{equation}
    \label{eq:60}
    \frac{\partial L}{\partial q_{j}} -  \frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q}_{j}} \right) = 0
  \end{equation}
  即拉格朗日方程\ref{eq:28}

\section{拉格朗日乘子与约束条件}

\subsection{带约束的欧拉变分原理}

有两个关于$x$的函数$y(x)$、$z(x)$，求
\begin{equation}
  \label{eq:61}
  J = \int_{x_{1}}^{x_{2}} f \left\{ y(x),y'(x),z(x),z'(x);x \right\}
\end{equation}
的极值，有约束
\begin{equation}
  \label{eq:62}
  g \left\{ y(x),z(x);x \right\} = 0
\end{equation}
由\ref{eq:61}
\begin{equation}
  \label{eq:63}
  \delta J = \int_{x_{1}}^{x_{2}} \left[ \left( \dfrac{\partial f}{\partial y} - \dfrac{\dif}{\dif x} \dfrac{\partial f}{\partial y'} \right) \delta y  + \left( \dfrac{\partial f}{\partial z} - \dfrac{\dif}{\dif x} \dfrac{\partial f}{\partial z'} \right) \delta z \right] \dif x = 0
\end{equation}
\begin{equation}
  \label{eq:64}
  \delta g = \dfrac{\partial g}{\partial y} \delta y + \dfrac{\partial g}{\partial z} \delta z = 0
\end{equation}
引入拉格朗日乘子$\lambda (x)$
\begin{equation}
  \label{eq:65}
  \lambda (x) \delta g = \lambda (x) \left( \dfrac{\partial g}{\partial y} \delta y + \dfrac{\partial g}{\partial z} \delta z \right) = 0
\end{equation}
将\ref{eq:65}代入\ref{eq:63}
\begin{equation}
  \label{eq:66}
  \int_{x_{1}}^{x_{2}} \left[ \left( \dfrac{\partial f}{\partial y} - \dfrac{\dif}{\dif x} \dfrac{\partial f}{\partial y'} + \lambda (x) \dfrac{\partial g}{\partial y} \right) \delta y  + \left( \dfrac{\partial f}{\partial z} - \dfrac{\dif}{\dif x} \dfrac{\partial f}{\partial z'}  + \lambda (x) \dfrac{\partial g}{\partial z} \right) \delta z \right] \dif x = 0
\end{equation}
因此，我们有
\begin{equation}
  \label{eq:67}
  \dfrac{\partial f}{\partial y} - \dfrac{\dif}{\dif x} \dfrac{\partial f}{\partial y'} + \lambda (x) \dfrac{\partial g}{\partial y} = 0
\end{equation}
和
\begin{equation}
  \label{eq:68}
  \dfrac{\partial f}{\partial z} - \dfrac{\dif}{\dif x} \dfrac{\partial f}{\partial z'}  + \lambda (x) \dfrac{\partial g}{\partial z} = 0
\end{equation}
\subsection{带不定乘子的拉格朗日方程}
考察二维平面上的运动，拉格朗日量
\begin{equation}
  \label{eq:69}
  L \left( x, \dot{x}, y, \dot{y}; t \right)
\end{equation}
$x$和$y$之间有约束
\begin{equation}
  \label{eq:70}
  g \left( x, y ;t \right) = 0
\end{equation}
由\ref{eq:67}和\ref{eq:68}可知
\begin{equation}
  \label{eq:71}
  \dfrac{\partial L}{\partial x} - \dfrac{\dif}{\dif t} \dfrac{\partial L}{\partial \dot{x}} + \lambda (t) \dfrac{\partial g}{\partial x} = 0
\end{equation}
\begin{equation}
  \label{eq:72}
  \dfrac{\partial L}{\partial y} - \dfrac{\dif}{\dif t} \dfrac{\partial L}{\partial \dot{y}}  + \lambda (t) \dfrac{\partial g}{\partial y} = 0
\end{equation}
其中
\begin{equation}
  \label{eq:73}
  Q_{x} = \lambda (t) \dfrac{\partial g}{\partial x} 
\end{equation}
\begin{equation}
  \label{eq:74}
  Q_{y} =  \lambda (t) \dfrac{\partial g}{\partial y} 
\end{equation}
为约束力

\section{哈密顿动力学}

\subsection{广义动量}
由广义动量的定义\ref{eq:42}和拉格朗日方程\ref{eq:28}
\begin{equation}
  \label{eq:75}
  p_{j} = \frac{\partial L}{\partial \dot{q_{j}}}
\end{equation}
\begin{equation}
  \label{eq:76}
  \frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q_{j}}} \right) - \frac{\partial L}{\partial q_{j}} = 0
\end{equation}
得到
\begin{equation}
  \label{eq:77}
  \frac{\dif}{\dif t} \left( \frac{\partial L}{\partial \dot{q_{j}}} \right) = \frac{\partial L}{\partial q_{j}}
\end{equation}
进而得到
\begin{equation}
  \label{eq:78}
  \dot{p}_{j} = \frac{\partial L}{\partial q_{j}}
\end{equation}

\subsection{哈密顿正则方程}

由\ref{eq:35}，系统的哈密顿量
\begin{equation}
  \label{eq:79}
  H \left( p_{j},q_{j},t \right) = \sum\limits_{j} \frac{\partial L}{\partial \dot{q_{j}}} \dot{q_{j}} -L
\end{equation}
将\ref{eq:75}代入
\begin{equation}
  \label{eq:80}
  H = \sum\limits_{j} p_{j} \dot{q_{j}} -L \left( q_{j},\dot{q}_{j},t \right)
\end{equation}
对\ref{eq:80}求全微分
\begin{equation}
  \label{eq:81}
  \dif H  = \sum\limits_{j} \left(  \dot{q_{j}} \dif p_{j} + p_{j} \dif \dot{q}_{j} - \dfrac{\partial L}{\partial q_{j}} \dif q_{j} - \dfrac{\partial L}{\partial \dot{q}_{j}} \dif \dot{q}_j \right) - \dfrac{\partial L}{\partial t} \dif t
\end{equation}
将\ref{eq:75}和\ref{eq:78}带入
\begin{equation}
  \label{eq:82}
  \dif H = \sum\limits_{j} \left(  \dot{q_{j}} \dif p_{j} + p_{j} \dif \dot{q}_{j} - \dot{p}_{j} \dif q_{j} - p_{j} \dif \dot{q}_j \right) - \dfrac{\partial L}{\partial t} \dif t
\end{equation}
整理得到
\begin{equation}
  \label{eq:83}
  \dif H = \sum\limits_{j} \left(  \dot{q_{j}} \dif p_{j} - \dot{p}_{j} \dif q_{j} \right) - \dfrac{\partial L}{\partial t} \dif t
\end{equation}
又因为
\begin{equation}
  \label{eq:84}
  \dif H = \sum\limits_{j}\left( \dfrac{\partial H}{\partial p_{j}} \dif p_{j} + \dfrac{\partial H}{\partial q_{j}} \dif q_{j} \right) + \dfrac{\partial H}{\partial t} \dif t
\end{equation}
因此我们得到哈密顿正则方程
\begin{equation}
  \label{eq:85}
  \dot{q}_{j} = \dfrac{\partial H}{\partial p_{j}}
\end{equation}
\begin{equation}
  \label{eq:86}
  \dot{p}_{j} = -\dfrac{\partial H}{\partial q_{j}}
\end{equation}
\begin{equation}
  \label{eq:87}
  \dfrac{\partial H}{\partial t} = - \dfrac{\partial L}{\partial t}
\end{equation}

\subsection{泊松括号}

\begin{equation}
  \label{eq:88}
  \left\{ u, v \right\} = \sum\limits_{j} \left( \dfrac{\partial u}{\partial q_{j}} \dfrac{\partial v}{\partial p_{j}} - \dfrac{\partial u}{\partial p_{j}} \dfrac{\partial v}{\partial q_{j}} \right)
\end{equation}
用法
\begin{equation}
  \label{eq:89}
  \dfrac{\dif u}{\dif t} = \sum\limits_{j} \left( \dfrac{\partial u}{\partial q_{j}} \dot{q}_{j} + \dfrac{\partial u}{\partial p_{j}} \dot{p}_{j} \right) + \dfrac{\partial u}{\partial t} = \sum\limits_{j} \left( \dfrac{\partial u}{\partial q_{j}} \dfrac{\partial H}{\partial p_{j}} - \dfrac{\partial u}{\partial p_{j}} \dfrac{\partial H}{\partial q_{j}} \right) + \dfrac{\partial u}{\partial t}
\end{equation}
可以简写为
\begin{equation}
  \label{eq:90}
  \dfrac{\dif u}{\dif t} = \left\{ u, H \right\} + \dfrac{\partial u}{\partial t}
\end{equation}

\section{有心运动}

\subsection{基本概念}

考虑两个质点的系统，系统的质心是$R$，定义等效质量$\mu$
\begin{equation}
  \label{eq:91}
  \mu = \dfrac{m_{1} m_{2}}{m_{1} + m_{2}} 
\end{equation}
则系统的动能为
\begin{equation}
  \label{eq:92}
  T = \dfrac{1}{2} \left( m_{1} + m_{2} \right) \dot{\mathbf{R}}^{2} + \dfrac{1}{2} \mu \dot{\mathbf{r}}^{2}
\end{equation}
系统的势能为$U(r)$，则
\begin{equation}
  \label{eq:93}
  L = T - U =  \dfrac{1}{2} \left( m_{1} + m_{2} \right) \dot{\mathbf{R}}^{2} + \dfrac{1}{2} \mu \dot{\mathbf{r}}^{2} - U(r)
\end{equation}
因为有
\begin{equation}
  \label{eq:94}
  \left( m_{1} + m_{2} \right)\ddot{\mathbf{R}} = 0
\end{equation}
式\ref{eq:93}的第一项可以丢弃
\begin{equation}
  \label{eq:95}
  L = \dfrac{1}{2} \mu \dot{\mathbf{r}}^{2} - U(r)
\end{equation}
用极坐标表示
\begin{equation}
  \label{eq:96}
  L = \dfrac{1}{2} \mu \left( \dot{r}^{2} + r^{2} \dot{\theta}^{2} \right) - U(r)
\end{equation}
广义角动量为
\begin{equation}
  \label{eq:97}
  l = p_{\theta} = \dfrac{\partial L}{\partial \dot{\theta}} = \mu r^{2} \dot{\theta} = \mathrm{const} 
\end{equation}
面积速度为
\begin{equation}
  \label{eq:98}
  \dfrac{\dif A }{\dif t} = \dfrac{1}{2} r^{2} \dif \theta = \dfrac{l}{2\mu} = \mathrm{const}
\end{equation}
总能量为
\begin{equation}
  \label{eq:99}
  E = T + U = \dfrac{1}{2} \mu \left( \dot{r}^{2} + r^{2} \dot{\theta}^{2} \right) + U(r) = \sqrt{ \dfrac{1}{2} \mu \dot{r}^{2} + \dfrac{1}{2} \dfrac{l^{2}}{\mu r^{2}} + U(r) }
\end{equation}

\subsection{运动方程的求解}

\subsubsection{第一种办法}

可以用式\ref{eq:97}和式\ref{eq:99}解出$\dot{\theta}$和$\dot{r}$
\begin{equation}
  \label{eq:100}
  \dot{\theta} = \dfrac{l}{\mu r^{2}} 
\end{equation}
\begin{equation}
  \label{eq:101}
  \dot{r} = \pm \sqrt{\dfrac{2}{\mu} \left[ E - U(r) \right] - \dfrac{l^{2}}{\mu^{2} r^{2}} }
\end{equation}
并用
\begin{equation}
  \label{eq:102}
  \dfrac{\dif \theta}{\dif r} = \dfrac{\dot{\theta}}{\dot{r}} 
\end{equation}
并积分解出
\begin{equation}
  \label{eq:103}
  \theta (r) = \pm \int \dfrac{\dot{\theta}}{\dot{r}} \dif r + \mathrm{const}= \pm \int \dfrac{\dfrac{l}{\mu r^{2}}}{\sqrt{\dfrac{2}{\mu} \left[ E - U(r) \right] - \dfrac{l^{2}}{\mu^{2} r^{2}} }} \dif r + \mathrm{const}
\end{equation}

\subsubsection{第二种解法}

拉格朗日方程
\begin{equation}
  \label{eq:104}
  \dfrac{\partial L}{\partial r} - \dfrac{\dif}{\dif t} \dfrac{\partial L}{\partial \dot{r}} = 0
\end{equation}
将式\ref{eq:96}代入
\begin{equation}
  \label{eq:105}
  \mu r \dot{\theta}^{2} - \dfrac{\partial U}{\partial r} - \mu \ddot{r} = 0
\end{equation}
整理得到
\begin{equation}
  \label{eq:106}
  -\mu r \dot{\theta}^{2} + \mu \ddot{r} = - \dfrac{\partial U}{\partial r}
\end{equation}
\begin{equation}
  \label{eq:107}
  \mu \left( \ddot{r} - r \dot{\theta}^{2} \right) = F(r)
\end{equation}
换元，另
\begin{equation}
  \label{eq:108}
  u = \dfrac{1}{r}
\end{equation}
则
\begin{equation}
  \label{eq:109}
  \dfrac{\dif^{2} u}{\dif \theta^{2}} = - \dfrac{\mu^{2}}{l^2} r^{2} \ddot{r}  
\end{equation}
\begin{equation}
  \label{eq:110}
  \ddot{r} = - \dfrac{1}{r^{2}} \dfrac{l^2}{\mu^{2}} \dfrac{\dif^{2} u}{\dif \theta^{2}} = - u^{2} \dfrac{l^2}{\mu^{2}} \dfrac{\dif^{2} u}{\dif \theta^{2}} 
\end{equation}
结合
\begin{equation}
  \label{eq:111}
  l = \mu r^{2} \dot{\theta}
\end{equation}
即
\begin{equation}
  \label{eq:112}
  \dot{\theta}^{2} = \dfrac{l^{2}}{\mu^{2} r^{4}} 
\end{equation}
将\ref{eq:112}与\ref{eq:110}代入\ref{eq:107}
\begin{equation}
  \label{eq:113}
  \mu \left( - u^{2} \dfrac{l^2}{\mu^{2}} \dfrac{\dif^{2} u}{\dif \theta^{2}}  - r \dfrac{l^{2}}{\mu^{2} r^{4}}  \right) = F(r)
\end{equation}
\begin{equation}
  \label{eq:114}
  \left( - u^{2} \dfrac{l^2}{\mu} \dfrac{\dif^{2} u}{\dif \theta^{2}}  - r \dfrac{l^{2}}{\mu r^{4}}  \right) = F(r)
\end{equation}
\begin{equation}
  \label{eq:115}
  \left( - u^{2} \dfrac{l^2}{\mu} \dfrac{\dif^{2} u}{\dif \theta^{2}}  - \frac{l^{2}u^{3}}{\mu}  \right) = F(r)
\end{equation}
\begin{equation}
  \label{eq:116}
    \left( \dfrac{\dif^{2} u}{\dif \theta^{2}}  + u   \right) = - \dfrac{\mu}{u^{2} l^{2}}  F(r)
\end{equation}
即
\begin{equation}
  \label{eq:117}
  \dfrac{\dif^{2}}{\dif \theta^{2}}\left( \dfrac{1}{r}     \right) + \dfrac{1}{r}  = - \dfrac{\mu r^{2}}{l^{2}}  F(r)
\end{equation}

\subsection{有效势能}

由式\ref{eq:103}分母，
\begin{equation}
  \label{eq:118}
    \sqrt{\dfrac{2}{\mu} \left[ E - U(r) \right] - \dfrac{l^{2}}{\mu^{2} r^{2}} } = \sqrt{\dfrac{2}{\mu} \left[ E - \left( U(r)  + \dfrac{l^{2}}{2 \mu r^{2}} \right) \right]}
\end{equation}
定义有效势能$V(r)$
\begin{equation}
  \label{eq:119}
  V(r) = U(r)  + \dfrac{l^{2}}{2 \mu r^{2}}
\end{equation}
离心势能
\begin{equation}
  \label{eq:120}
  U_{C}(r) = \dfrac{l^{2}}{2 \mu r^{2}}
\end{equation}

\section{刚体的运动}

转动惯量的张量定义为

\begin{equation}
  \label{eq:121}
  \mathbf{I} = \left[ \begin{array}{ccc}
                       \sum\limits_{\alpha} m_{\alpha} \left( x_{\alpha ,2} x_{\alpha ,3} \right) & - \sum\limits_{\alpha} m_{\alpha} x_{\alpha ,1} x_{\alpha, 2} & - \sum\limits_{\alpha} m_{\alpha} x_{\alpha ,1} x_{\alpha, 3}\\
                       - \sum\limits_{\alpha} m_{\alpha} x_{\alpha ,2} x_{\alpha, 1} & \sum\limits_{\alpha} m_{\alpha} \left( x_{\alpha ,1} x_{\alpha ,3} \right) & - \sum\limits_{\alpha} m_{\alpha} x_{\alpha ,2} x_{\alpha, 3}\\
                       - \sum\limits_{\alpha} m_{\alpha} x_{\alpha ,3} x_{\alpha, 1} & - \sum\limits_{\alpha} m_{\alpha} x_{\alpha ,3} x_{\alpha, 2} & \sum\limits_{\alpha} m_{\alpha} \left( x_{\alpha ,1} x_{\alpha ,2} \right)
                      \end{array} \right ] 
\end{equation}
定义
\begin{equation}
  \label{eq:122}
  \mathbf{I} = \left[
    \begin{array}{ccc}
                       I_{11} & I_{12} & I_{13} \\
		    I_{21} & I_{22} & I_{23} \\
		    I_{31} & I_{32} & I_{33}

    \end{array} \right ]
\end{equation}
刚体的转动动能
\begin{equation}
  \label{eq:123}
  T_{rot} = \dfrac{1}{2} \mathbf{\omega}' \mathbf{I} \mathbf{\omega}
\end{equation}
这里面的$\mathbf{\omega}$是列向量，刚体的角动量
\begin{equation}
  \label{eq:124}
  \mathbf{L} = \mathbf{I} \mathbf{\omega}
\end{equation}
$\mathbf{I}$是对称的，可以相似对角化相似对角化后的转动惯量
\begin{equation}
  \label{eq:125}
  \mathbf{I'} = \mathbf{\lambda}' \mathbf{I} \mathbf{\lambda}
\end{equation}
\begin{equation}
  \label{eq:126}
  \mathbf{\omega}' =  \mathbf{\lambda}' \mathbf{\omega}
\end{equation}

\end{document}